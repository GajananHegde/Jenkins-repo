server {
  if ($request_method !~ ^(GET|POST|PUT|DELETE|OPTIONS)$) {
    return 444;
  }
  #remove query strings - updated - Ishwarya - 200922
  if ($args ~* "(ecid=|va-|DT)") {
    #? in uri? drops the ecid query string
    rewrite ^(.*)$ $uri? permanent;
  }
  listen 80;

  server_name commercial.bmo.com www.commercial.bmo.com;
  server_tokens off;

  ####
  ##updates - 14-10-22
  #rewrite ^/franchisefinance\/(.*) /en/us/industry-expertise/franchise-finance/ permanent;
  rewrite ^/en/us/industry\-expertise/franchise\-finance/ /en/us/industry-expertise/franchise/ permanent;
  rewrite ^/franchisefinance /en/us/industry-expertise/franchise/ permanent;
  #####
  rewrite ^/en/we\-can\-help/loan\-syndication\-agency\-services/\?ecid\=va\-US36556COM1\-SJBMO24 /en/us/we-can-help/loan-syndication-agency-services/ permanent;
  #changed
  rewrite ^\/(en)\/(we-can-help)\/(manage-cash-flow)\/(.*) /en/us/we-can-help/manage-cash-flow/ permanent; 
  rewrite ^/en/we-can-help/business-strategy/\?ecid=va-US36556COM1-SJBMO19	/en/us/we-can-help/business-strategy/ permanent;
  rewrite ^/en/we-can-help/addressing-covid-19/	/en/us/we-can-help/addressing-covid-19/ permanent; 
  #changed
  rewrite ^\/(en)\/(we-can-help)/(manage-deposits)\/(.*)$	/en/us/we-can-help/manage-cash-flow/ permanent; 
  rewrite ^/en/we-can-help/economic-insights/\?ecid=va-US36556COM1-SJBMO23	/en/us/we-can-help/economic-insights/ permanent;
  rewrite ^/en/we-can-help/equipment-financing-leasing/	/en/us/we-can-help/equipment-financing-leasing/ permanent;
  rewrite ^/en/we-can-help/finance-growth/\?ecid=va-US36556COM1-SJBMO29	/en/us/we-can-help/finance-growth/ permanent;
  #rewrite ^/en/we-can-help/doing-business-internationally/\?ecid=va-US36556COM1-SJBMO20	/en/us/we-can-help/doing-business-internationally/ permanent;

  ####
  rewrite ^/en/we-can-help/equipment-financing-leasing/\?ecid=va-US36556COM1-SJBMO22	/en/us/we-can-help/equipment-financing-leasing/ permanent;
  rewrite ^/en/we-can-help/mergers-acquisitions/\?ecid=va-US36556COM1-SJBMO28	/en/us/we-can-help/mergers-acquisitions/ permanent;
  rewrite ^/en/we-can-help/manage-risk/\?ecid=va-US36556COM1-SJBMO27	/en/us/we-can-help/manage-risk/ permanent;

  #####
  rewrite ^/en/industry-expertise/manufacturing/\?ecid=va-US36556COM1-SJBMO38	/en/us/industry-expertise/manufacturing/ permanent;
  rewrite ^/en/industry\-expertise/media\-finance\/(.*)$ /en/us/industry-expertise/media/ permanent;
  rewrite ^/en/industry-expertise/professional-services/	/en/us/industry-expertise/professional-services/ permanent;
  rewrite ^/en/industry-expertise/commercial-real-estate/\?ecid=va-US36556COM1-SJBMO37	/en/us/industry-expertise/commercial-real-estate/ permanent;
  rewrite ^/en/industry-expertise/retail-wholesale-distribution/\?ecid=va-US36556COM1-SJBMO41	/en/us/industry-expertise/retail-wholesale-distribution/ permanent;
  rewrite ^/en/industry-expertise/trucking/\?ecid=va-US36556COM1-SJBMO35  /en/us/industry-expertise/trucking/ permanent;
  rewrite ^/en/industry-expertise/agriculture/\?ecid=va-US36556COM1-SJBMO31 /en/us/industry-expertise/agriculture/ permanent;
  rewrite ^/en/industry-expertise/auto-dealerships/\?ecid=va-US36556COM1-SJBMO32  /en/us/industry-expertise/auto-dealerships/ permanent;
  rewrite ^/en/industry-expertise/engineering-construction/\?ecid=va-US36556COM1-SJBMO33  /en/us/industry-expertise/engineering-construction/ permanent;
  rewrite ^/en/industry-expertise/healthcare/ /en/us/industry-expertise/healthcare/ permanent;
  rewrite ^\/(en)\/(industry-expertise)\/(hospitality)\/(.*)$ /en/us/ permanent;

  #####
  rewrite ^/we-can-help/asset-based-lending/\?ecid=va-US36556COM1-SJBMO18 /en/us/we-can-help/asset-based-lending/ permanent;
  #####

  rewrite ^/industry-expertise/engineering-construction/\?ecid\=va-DT-9223-SKBMOH22 /en/us/industry-expertise/engineering-construction/  permanent;

  ####
  #rewrite ^/en/we\-can\-help/doing\-business\-in\-canada/(.*)$ /en/ca/we\-can\-help/doing\-business\-us/ permanent;

  #DHD-18372
  rewrite ^/realestate/	/en/us/industry-expertise/commercial-real-estate/ last;

  #default rewrites
  rewrite ^\/(en)\/(resource)\/(.*)$ https://commercial.bmo.com/$1/us/$2/$3 last;
  rewrite ^\/(en)\/(industry-expertise)\/(.*)$ https://commercial.bmo.com/$1/us/$2/$3 last;
  rewrite ^\/(en)\/(we-can-help)\/(.*)$ https://commercial.bmo.com/$1/us/$2/$3 last;
  rewrite ^\/(en)\/(our-bankers)\/(.*)$ https://commercial.bmo.com/$1/us/$2/$3 last;
  rewrite ^\/(en)\/(who-we-are)\/(.*)$ https://commercial.bmo.com/$1/us/$2/$3 last;
  rewrite ^\/ https://commercial.bmo.com/en/us last;

}
